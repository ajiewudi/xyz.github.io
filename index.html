<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»™ç‰¹åˆ«çš„ä½ </title>
    <style>
        /* --- å…¨å±€è®¾ç½® --- */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden; /* ç¦æ­¢æ»šåŠ¨ï¼Œè®©å›¾ç‰‡åœ¨å±å¹•å†…é£˜ */
            background-color: #fcf6f5; /* æ¸©æš–çš„ç±³ç™½è‰²èƒŒæ™¯ */
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        /* --- æ¼‚æµ®å›¾ç‰‡åŒºåŸŸ --- */
        #floating-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; /* åœ¨æœ€åº•å±‚ */
            pointer-events: none; /* è®©é¼ æ ‡èƒ½é€è¿‡å›¾ç‰‡ç‚¹å‡»ä¸‹é¢çš„ä¸œè¥¿ */
        }

        .float-img {
            position: absolute;
            opacity: 0.8;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.5s ease;
            /* é»˜è®¤æœ€å¤§å®½åº¦é™åˆ¶ä¸€ä¸‹ï¼Œé˜²æ­¢ä¸€å¼ å›¾å æ»¡å±å¹•ï¼Œä½ å¯ä»¥åˆ æ‰è¿™è¡Œè®©å®ƒå®Œå…¨åŸå›¾ */
            max-width: 300px; 
        }

        /* --- å·¦ä¾§æ‚¬æŒ‚æŒ‰é’® --- */
        .sidebar {
            position: fixed;
            left: 20px;
            top: 100px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            z-index: 100; /* ä¿è¯æŒ‰é’®åœ¨æœ€ä¸Šé¢ */
        }

        .cute-btn {
            background-color: #ffb7b2;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 20px 20px 20px 0; /* ç¨å¾®æœ‰ç‚¹é€ å‹ */
            font-size: 16px;
            cursor: pointer;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s;
            position: relative;
        }

        .cute-btn:hover {
            transform: scale(1.1) rotate(2deg);
            background-color: #ff9e99;
        }

        /* ç»³å­æ•ˆæœï¼ˆè§†è§‰è£…é¥°ï¼‰ */
        .cute-btn::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 10px;
            width: 2px;
            height: 20px;
            background-color: #ccc;
        }

        /* --- ä¿¡ä»¶å¼¹çª— --- */
        #modal-overlay {
            display: none; /* é»˜è®¤éšè— */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 200;
            justify-content: center;
            align-items: center;
        }

        .letter-paper {
            background: #fffdf0;
            width: 90%;
            max-width: 500px;
            padding: 40px;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            position: relative;
            background-image: linear-gradient(#e0e0e0 1px, transparent 1px);
            background-size: 100% 30px; /* ä¿¡çº¸çº¿æ¡ */
            line-height: 30px;
        }

        .letter-content {
            font-size: 18px;
            color: #555;
            min-height: 150px;
            white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œ */
        }

        .letter-date {
            text-align: right;
            font-size: 14px;
            color: #999;
            margin-top: 20px;
        }

        .letter-controls {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ctrl-btn {
            background: #a2d2ff;
            border: none;
            padding: 8px 15px;
            border-radius: 15px;
            color: white;
            cursor: pointer;
        }
        .ctrl-btn:disabled {
            background: #ddd;
            cursor: not-allowed;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #aaa;
        }

        /* --- å›ä¿¡è¾“å…¥æ¡†åŒºåŸŸ --- */
        #reply-area {
            display: none;
            margin-top: 20px;
            border-top: 2px dashed #ddd;
            padding-top: 10px;
        }
        #reply-input {
            width: 100%;
            height: 80px;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            box-sizing: border-box;
            font-family: inherit;
        }

    </style>
</head>
<body>

    <!-- æ¼‚æµ®å›¾ç‰‡å®¹å™¨ -->
    <div id="floating-container">
        <!-- è¿™é‡Œå¯ä»¥æ”¾å‡ å¼ é»˜è®¤çš„å›¾ç‰‡ï¼Œé˜²æ­¢ä¸€å¼€å§‹æ˜¯ç©ºçš„ -->
        <!-- è¿™é‡Œçš„ src ä½ éœ€è¦æ¢æˆä½ è‡ªå·±çš„å›¾ç‰‡é“¾æ¥ï¼Œæˆ–è€…å°±ç•™ç€ç©ºçš„ç­‰ä¸Šä¼  -->
        <!-- <img src="ä½ çš„å›¾ç‰‡é“¾æ¥.jpg" class="float-img"> -->
    </div>

    <!-- å·¦ä¾§æŒ‰é’® -->
    <div class="sidebar">
        <button class="cute-btn" onclick="openLetter()">ğŸ•Šï¸ é£é¸½ä¼ ä¹¦</button>
        <button class="cute-btn" onclick="triggerUpload()">ğŸ“· ç‚¹å‡»æäº¤</button>
    </div>

    <!-- éšè—çš„æ–‡ä»¶ä¸Šä¼ è¾“å…¥æ¡† -->
    <input type="file" id="file-input" multiple accept="image/*" style="display: none;" onchange="handleFiles(this.files)">

    <!-- ä¿¡ä»¶å¼¹çª— -->
    <div id="modal-overlay">
        <div class="letter-paper">
            <div class="close-btn" onclick="closeLetter()">Ã—</div>
            
            <div id="letter-display-area">
                <div class="letter-content" id="content-text">è¿™é‡Œæ˜¯ä¿¡çš„å†…å®¹...</div>
                <div class="letter-date" id="content-date">2023-12-25</div>
            </div>

            <div id="reply-area">
                <p style="font-size: 14px; color: #888;">ç»™ TA çš„å›ä¿¡ï¼š</p>
                <textarea id="reply-input" placeholder="å†™ä¸‹ä½ æƒ³è¯´çš„è¯..."></textarea>
                <button class="ctrl-btn" style="margin-top: 10px; background-color: #ffb7b2;" onclick="sendReply()">å‘é€</button>
            </div>

            <div class="letter-controls">
                <button class="ctrl-btn" id="prev-btn" onclick="changeLetter(-1)">ä¸Šä¸€å°</button>
                <button class="ctrl-btn" style="background-color: #ff9e99;" onclick="showReplyBox()">ğŸ’Œ å›ä¿¡</button>
                <button class="ctrl-btn" id="next-btn" onclick="changeLetter(1)">ä¸‹ä¸€å°</button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. ä¿¡ä»¶æ•°æ®è®¾ç½® (è¯·åœ¨è¿™é‡Œä¿®æ”¹ä½ æƒ³å¯¹ä»–è¯´çš„è¯) ---
        const letters = [
            {
                text: "å—¨ï¼\n\nå¾ˆé«˜å…´ä½ èƒ½ç‚¹å¼€è¿™ä¸ªæŒ‰é’®ã€‚\nå…¶å®æˆ‘æƒ³åšä¸€ä¸ªç½‘ç«™ç»™ä½ çœ‹å¾ˆä¹…äº†ã€‚\n\nè¿™æ˜¯ç¬¬ä¸€å°ä¿¡ï¼Œç”¨æ¥æµ‹è¯•ä¸€ä¸‹é£é¸½ä¼ ä¹¦å¥½ä¸å¥½ç”¨ã€‚",
                date: "2023å¹´10æœˆ1æ—¥ 14:00"
            },
            {
                text: "è¿™å‡ å¤©å¤©æ°”è½¬å‡‰äº†ï¼Œè®°å¾—å¤šç©¿ç‚¹è¡£æœã€‚\n\næˆ‘åœ¨å†™ä»£ç çš„æ—¶å€™å°±åœ¨æƒ³ï¼Œå¦‚æœè¿™äº›å›¾ç‰‡èƒ½ä»£è¡¨å¿ƒæƒ…å°±å¥½äº†ã€‚",
                date: "2023å¹´10æœˆ20æ—¥ 09:30"
            },
            {
                text: "è¿™æ˜¯ç¬¬ä¸‰å°ä¿¡ã€‚\n\nå¦‚æœä½ çœ‹åˆ°äº†è¿™é‡Œï¼Œè¯´æ˜ä½ å¾ˆæœ‰è€å¿ƒã€‚\nå¸Œæœ›ä½ ä»Šå¤©è¿‡å¾—å¼€å¿ƒï¼",
                date: "2024å¹´12æœˆ24æ—¥ 23:00"
            }
        ];

        let currentLetterIndex = 0;

        // --- 2. æ¼‚æµ®å›¾ç‰‡é€»è¾‘ ---
        const container = document.getElementById('floating-container');

        // è®©å›¾ç‰‡é£˜åŠ¨çš„å‡½æ•°
        function animateElement(element) {
            // éšæœºç”Ÿæˆèµ·å§‹ä½ç½®
            const startX = Math.random() * (window.innerWidth - 100);
            const startY = Math.random() * (window.innerHeight - 100);
            
            element.style.left = startX + 'px';
            element.style.top = startY + 'px';

            // éšæœºç”Ÿæˆé£˜åŠ¨é€Ÿåº¦å’Œæ–¹å‘
            let velocityX = (Math.random() - 0.5) * 2; // é€Ÿåº¦ -1 åˆ° 1
            let velocityY = (Math.random() - 0.5) * 2;

            function move() {
                let rect = element.getBoundingClientRect();
                let currentLeft = parseFloat(element.style.left);
                let currentTop = parseFloat(element.style.top);

                // ç¢°åˆ°è¾¹ç•Œåå¼¹
                if (rect.left <= 0 || rect.right >= window.innerWidth) velocityX *= -1;
                if (rect.top <= 0 || rect.bottom >= window.innerHeight) velocityY *= -1;

                element.style.left = (currentLeft + velocityX) + 'px';
                element.style.top = (currentTop + velocityY) + 'px';

                requestAnimationFrame(move);
            }
            move();
        }

        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        function triggerUpload() {
            document.getElementById('file-input').click();
        }

        function handleFiles(files) {
            if (!files.length) return;

            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();

                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'float-img';
                    
                    // éšæœºå¤§å°ï¼Œå¦‚æœä½ æƒ³å®Œå…¨åŸå›¾ï¼Œå¯ä»¥æ³¨é‡Šæ‰ä¸‹é¢è¿™è¡Œï¼Œä½†å»ºè®®ä¿ç•™ä»¥å…å›¾ç‰‡å¤ªå¤§æ’‘çˆ†
                    // img.style.width = (Math.random() * 200 + 100) + 'px'; 
                    
                    container.appendChild(img);
                    animateElement(img); // å¼€å§‹é£˜åŠ¨
                }
                reader.readAsDataURL(file);
            }
            // æç¤ºç”¨æˆ·
            alert('å›¾ç‰‡å·²æäº¤ï¼å®ƒä»¬æ­£åœ¨å±å¹•ä¸Šå¼€å§‹æ¼‚æµäº†~');
        }

        // --- 3. ä¿¡ä»¶äº¤äº’é€»è¾‘ ---
        const modal = document.getElementById('modal-overlay');
        const contentText = document.getElementById('content-text');
        const contentDate = document.getElementById('content-date');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const replyArea = document.getElementById('reply-area');

        function openLetter() {
            modal.style.display = 'flex';
            renderLetter();
        }

        function closeLetter() {
            modal.style.display = 'none';
            replyArea.style.display = 'none'; // å…³æ‰æ—¶é‡ç½®å›ä¿¡æ¡†
        }

        function renderLetter() {
            const letter = letters[currentLetterIndex];
            contentText.textContent = letter.text;
            contentDate.textContent = letter.date;

            // æ§åˆ¶æŒ‰é’®æ˜¯å¦å¯ç”¨
            prevBtn.disabled = currentLetterIndex === 0;
            nextBtn.disabled = currentLetterIndex === letters.length - 1;
        }

        function changeLetter(step) {
            currentLetterIndex += step;
            renderLetter();
        }

        function showReplyBox() {
            replyArea.style.display = 'block';
        }

        function sendReply() {
            const replyText = document.getElementById('reply-input').value;
            if (replyText.trim() === "") {
                alert("ä¿¡çº¸æ˜¯ç©ºçš„å“¦ï¼Œå†™ç‚¹ä»€ä¹ˆå§ï¼");
                return;
            }
            
            // è¿™é‡Œçš„æ¨¡æ‹Ÿå‘é€
            alert("å›ä¿¡å·²ç”±é£é¸½å¸¦èµ°ï¼(æ¨¡æ‹Ÿå‘é€æˆåŠŸ)");
            
            // å¦‚æœä½ æƒ³çœŸçš„å‘é‚®ä»¶ï¼Œå¯ä»¥ç”¨ä¸‹é¢è¿™è¡Œä»£ç æ›¿æ¢ä¸Šé¢çš„ alertï¼š
            // window.location.href = `mailto:ä½ çš„é‚®ç®±@example.com?subject=æ¥è‡ªç½‘é¡µçš„å›ä¿¡&body=${replyText}`;

            document.getElementById('reply-input').value = ""; // æ¸…ç©º
            replyArea.style.display = 'none';
        }

    </script>
</body>
</html>
