<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»™ç‰¹åˆ«çš„ä½ </title>
    <style>
        /* --- å…¨å±€è®¾ç½® --- */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden; 
            background-color: #fcf6f5; 
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        /* --- æ¼‚æµ®å›¾ç‰‡åŒºåŸŸ --- */
        #floating-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; 
            pointer-events: none; 
        }

        .float-img {
            position: absolute;
            opacity: 0.8; 
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15); /* ç¨å¾®åŠ é‡é˜´å½±è®©å›¾ç‰‡æ›´ç«‹ä½“ */
            transition: transform 0.5s ease;
            max-width: 250px; /* é™åˆ¶è‡ªåŠ¨åŠ è½½å›¾ç‰‡çš„å¤§å° */
            max-height: 250px;
            object-fit: cover;
        }

        /* --- å·¦ä¾§æ‚¬æŒ‚æŒ‰é’® --- */
        .sidebar {
            position: fixed;
            left: 20px;
            top: 100px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            z-index: 100; 
        }

        .cute-btn {
            background-color: #ffb7b2;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 20px 20px 20px 0; 
            font-size: 16px;
            cursor: pointer;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s;
            position: relative;
        }

        .cute-btn:hover {
            transform: scale(1.1) rotate(2deg);
            background-color: #ff9e99;
        }
        
        .cute-btn::before {
            content: '';
            position: absolute;
            top: -20px; left: 10px;
            width: 2px; height: 20px;
            background-color: #ccc;
        }

        /* --- ä¿¡ä»¶å¼¹çª— (æ ·å¼ä¿æŒä¸å˜) --- */
        #modal-overlay {
            display: none; 
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 200;
            justify-content: center; align-items: center;
        }

        .letter-paper {
            background: #fffdf0;
            width: 90%; max-width: 500px;
            padding: 40px;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            position: relative;
            background-image: linear-gradient(#e0e0e0 1px, transparent 1px);
            background-size: 100% 30px; 
            line-height: 30px;
        }

        .letter-content { font-size: 18px; color: #555; min-height: 150px; white-space: pre-wrap; }
        .letter-date { text-align: right; font-size: 14px; color: #999; margin-top: 20px; }
        .letter-controls { margin-top: 30px; display: flex; justify-content: space-between; align-items: center; }
        .ctrl-btn { background: #a2d2ff; border: none; padding: 8px 15px; border-radius: 15px; color: white; cursor: pointer; }
        .ctrl-btn:disabled { background: #ddd; cursor: not-allowed; }
        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; color: #aaa; }
        
        #reply-area { display: none; margin-top: 20px; border-top: 2px dashed #ddd; padding-top: 10px; }
        #reply-input { width: 100%; height: 80px; border: 1px solid #ddd; border-radius: 5px; padding: 10px; box-sizing: border-box; font-family: inherit; }

    </style>
</head>
<body>

    <div id="floating-container"></div>

    <div class="sidebar">
        <button class="cute-btn" onclick="openLetter()">ğŸ•Šï¸ é£é¸½ä¼ ä¹¦</button>
        <!-- æ³¨æ„ï¼šè¿™ä¸ªæäº¤æŒ‰é’®ç°åœ¨ä¸»è¦ç”¨äºâ€œç©ä¸€ä¸‹â€ï¼Œæ— æ³•æ°¸ä¹…ä¿å­˜ -->
        <button class="cute-btn" onclick="triggerUpload()">ğŸ“· æ­¤æ—¶æ­¤åˆ»</button>
    </div>

    <input type="file" id="file-input" multiple accept="image/*" style="display: none;" onchange="handleFiles(this.files)">

    <div id="modal-overlay">
        <div class="letter-paper">
            <div class="close-btn" onclick="closeLetter()">Ã—</div>
            <div id="letter-display-area">
                <div class="letter-content" id="content-text">...</div>
                <div class="letter-date" id="content-date">...</div>
            </div>
            <div id="reply-area">
                <p style="font-size: 14px; color: #888;">ç»™ TA çš„å›ä¿¡ï¼š</p>
                <textarea id="reply-input" placeholder="å†™ä¸‹ä½ æƒ³è¯´çš„è¯..."></textarea>
                <button class="ctrl-btn" style="margin-top: 10px; background-color: #ffb7b2;" onclick="sendReply()">å‘é€</button>
            </div>
            <div class="letter-controls">
                <button class="ctrl-btn" id="prev-btn" onclick="changeLetter(-1)">ä¸Šä¸€å°</button>
                <button class="ctrl-btn" style="background-color: #ff9e99;" onclick="showReplyBox()">ğŸ’Œ å›ä¿¡</button>
                <button class="ctrl-btn" id="next-btn" onclick="changeLetter(1)">ä¸‹ä¸€å°</button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. é…ç½®åŒºåŸŸ ---
        const githubUsername = 'ajiewudi'; // ä½ çš„ç”¨æˆ·å
        const repoName = 'ajiewudi.github.io'; // ä½ çš„ä»“åº“å
        const imageFolder = 'images'; // åˆšæ‰å»ºçš„æ–‡ä»¶å¤¹åå­—

        const letters = [
            { text: "å—¨ï¼\n\nè¿™äº›æ¼‚æµ®çš„ç…§ç‰‡ï¼Œéƒ½æ˜¯æˆ‘æƒ³å’Œä½ åˆ†äº«çš„ç¬é—´ã€‚", date: "2023-12-25" },
            { text: "è™½ç„¶ä»£ç ä¸èƒ½ä¿å­˜ä½ ç°åœ¨çš„ä¸Šä¼ ï¼Œ\nä½†æˆ‘å·²ç»æŠŠæœ€ç¾å¥½çš„å›å¿†éƒ½è—åœ¨äº†æ–‡ä»¶å¤¹é‡Œã€‚", date: "2023-12-26" },
        ];

        // --- 2. è‡ªåŠ¨åŠ è½½ GitHub æ–‡ä»¶å¤¹é‡Œçš„å›¾ç‰‡ ---
        window.onload = function() {
            // ä½¿ç”¨ GitHub API è·å–æ–‡ä»¶å¤¹å†…å®¹
            const apiUrl = `https://api.github.com/repos/${githubUsername}/${repoName}/contents/${imageFolder}`;

            fetch(apiUrl)
            .then(response => {
                if (response.ok) return response.json();
                throw new Error('æ–‡ä»¶å¤¹ä¸å­˜åœ¨æˆ–ä¸ºç©º');
            })
            .then(data => {
                data.forEach(file => {
                    // æ£€æŸ¥æ˜¯å¦æ˜¯å›¾ç‰‡æ–‡ä»¶ (jpg, png, jpeg, gif)
                    if (file.name.match(/\.(jpg|jpeg|png|gif)$/i)) {
                        createFloatingImage(file.download_url);
                    }
                });
            })
            .catch(error => {
                console.log("æ²¡æœ‰è‡ªåŠ¨åŠ è½½å›¾ç‰‡ï¼Œå¯èƒ½æ˜¯è¿˜æ²¡æœ‰åˆ›å»º images æ–‡ä»¶å¤¹ã€‚", error);
            });
        };

        // --- 3. æ¼‚æµ®å›¾ç‰‡é€»è¾‘ ---
        const container = document.getElementById('floating-container');

        function createFloatingImage(url) {
            const img = document.createElement('img');
            img.src = url;
            img.className = 'float-img';
            container.appendChild(img);
            
            // å›¾ç‰‡åŠ è½½å®Œæˆåå¼€å§‹åŠ¨ï¼Œé¿å…ä½ç½®è®¡ç®—é”™è¯¯
            img.onload = () => animateElement(img);
        }

        function animateElement(element) {
            const startX = Math.random() * (window.innerWidth - 100);
            const startY = Math.random() * (window.innerHeight - 100);
            element.style.left = startX + 'px';
            element.style.top = startY + 'px';

            let velocityX = (Math.random() - 0.5) * 1.5; 
            let velocityY = (Math.random() - 0.5) * 1.5;

            function move() {
                let rect = element.getBoundingClientRect();
                let currentLeft = parseFloat(element.style.left);
                let currentTop = parseFloat(element.style.top);

                if (rect.left <= 0 || rect.right >= window.innerWidth) velocityX *= -1;
                if (rect.top <= 0 || rect.bottom >= window.innerHeight) velocityY *= -1;

                element.style.left = (currentLeft + velocityX) + 'px';
                element.style.top = (currentTop + velocityY) + 'px';
                requestAnimationFrame(move);
            }
            move();
        }

        // --- 4. æŒ‰é’®ä¸Šä¼  (æœ¬åœ°ä¸´æ—¶å±•ç¤º) ---
        function triggerUpload() { document.getElementById('file-input').click(); }
        
        function handleFiles(files) {
            if (!files.length) return;
            for (let i = 0; i < files.length; i++) {
                const reader = new FileReader();
                reader.onload = function(e) { createFloatingImage(e.target.result); }
                reader.readAsDataURL(files[i]);
            }
            alert('ç…§ç‰‡å·²æ·»åŠ ï¼(æ³¨æ„ï¼šè¿™åªæ˜¯ä¸´æ—¶å±•ç¤ºï¼Œåˆ·æ–°åä¼šæ¶ˆå¤±å“¦ï¼Œæƒ³è¦æ°¸ä¹…ä¿å­˜è¯·å»åå°ä¸Šä¼ )');
        }

        // --- 5. ä¿¡ä»¶é€»è¾‘ ---
        let currentLetterIndex = 0;
        const modal = document.getElementById('modal-overlay');
        const contentText = document.getElementById('content-text');
        const contentDate = document.getElementById('content-date');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const replyArea = document.getElementById('reply-area');

        function openLetter() { modal.style.display = 'flex'; renderLetter(); }
        function closeLetter() { modal.style.display = 'none'; replyArea.style.display = 'none'; }
        
        function renderLetter() {
            const letter = letters[currentLetterIndex];
            contentText.textContent = letter.text;
            contentDate.textContent = letter.date;
            prevBtn.disabled = currentLetterIndex === 0;
            nextBtn.disabled = currentLetterIndex === letters.length - 1;
        }
        function changeLetter(step) { currentLetterIndex += step; renderLetter(); }
        function showReplyBox() { replyArea.style.display = 'block'; }
        function sendReply() { 
            document.getElementById('reply-input').value = ""; 
            replyArea.style.display = 'none';
            alert("å¿ƒæ„å·²æ”¶åˆ°~"); 
        }

    </script>
</body>
</html>
